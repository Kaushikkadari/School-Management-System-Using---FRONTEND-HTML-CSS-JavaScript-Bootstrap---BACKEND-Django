{% extends 'accounts/base_admin.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="mt-4">Edit Exam</h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{% url 'examinations' %}">Examinations</a></li>
                <li class="breadcrumb-item"><a href="{% url 'exam_detail' exam.id %}">{{ exam.title|default:exam.exam_type|title }}</a></li>
                <li class="breadcrumb-item active">Edit</li>
            </ol>
        </nav>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Edit Examination</h5>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row">
                            <!-- Exam Details -->
                            <div class="col-md-6">
                                <h6 class="mb-3">Exam Details</h6>
                                
                                <div class="mb-3">
                                    <label for="{{ form.course.id_for_label }}" class="form-label">Course *</label>
                                    {{ form.course }}
                                    {% if form.course.errors %}
                                        <div class="text-danger">{{ form.course.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <label for="{{ form.title.id_for_label }}" class="form-label">Exam Title</label>
                                    {{ form.title }}
                                    {% if form.title.errors %}
                                        <div class="text-danger">{{ form.title.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <label for="{{ form.exam_type.id_for_label }}" class="form-label">Exam Type *</label>
                                    {{ form.exam_type }}
                                    {% if form.exam_type.errors %}
                                        <div class="text-danger">{{ form.exam_type.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <label for="{{ form.date.id_for_label }}" class="form-label">Date & Time *</label>
                                    {{ form.date }}
                                    {% if form.date.errors %}
                                        <div class="text-danger">{{ form.date.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Additional Details -->
                            <div class="col-md-6">
                                <h6 class="mb-3">Additional Details</h6>
                                
                                <div class="mb-3">
                                    <label for="{{ form.duration.id_for_label }}" class="form-label">Duration (minutes) *</label>
                                    {{ form.duration }}
                                    {% if form.duration.errors %}
                                        <div class="text-danger">{{ form.duration.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <label for="{{ form.total_marks.id_for_label }}" class="form-label">Total Marks *</label>
                                    {{ form.total_marks }}
                                    {% if form.total_marks.errors %}
                                        <div class="text-danger">{{ form.total_marks.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <label for="{{ form.instructions.id_for_label }}" class="form-label">Instructions</label>
                                    {{ form.instructions }}
                                    {% if form.instructions.errors %}
                                        <div class="text-danger">{{ form.instructions.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Schedule Details -->
                        <hr class="my-4">
                        <h6 class="mb-3">Schedule Details</h6>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ schedule_form.room.id_for_label }}" class="form-label">Room *</label>
                                    {{ schedule_form.room }}
                                    {% if schedule_form.room.errors %}
                                        <div class="text-danger">{{ schedule_form.room.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ schedule_form.supervisor.id_for_label }}" class="form-label">Supervisor</label>
                                    {{ schedule_form.supervisor }}
                                    {% if schedule_form.supervisor.errors %}
                                        <div class="text-danger">{{ schedule_form.supervisor.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ schedule_form.start_time.id_for_label }}" class="form-label">Start Time *</label>
                                    {{ schedule_form.start_time }}
                                    {% if schedule_form.start_time.errors %}
                                        <div class="text-danger">{{ schedule_form.start_time.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ schedule_form.end_time.id_for_label }}" class="form-label">End Time *</label>
                                    {{ schedule_form.end_time }}
                                    {% if schedule_form.end_time.errors %}
                                        <div class="text-danger">{{ schedule_form.end_time.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Update Exam
                                </button>
                                <a href="{% url 'exam_detail' exam.id %}" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Initialize form styling
    $(document).ready(function() {
        // Add Bootstrap classes to form fields
        $('select, input, textarea').addClass('form-control');
        
        // Initialize datetime picker for date field
        if ($('#id_date').length) {
            $('#id_date').attr('type', 'datetime-local');
        }
        
        // Initialize time pickers
        if ($('#id_start_time').length) {
            $('#id_start_time').attr('type', 'time');
        }
        if ($('#id_end_time').length) {
            $('#id_end_time').attr('type', 'time');
        }
    });
</script>
{% endblock %} 